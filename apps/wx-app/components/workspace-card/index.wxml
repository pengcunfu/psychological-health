<wxs module="util" src="../../utils/util.wxs"></wxs>

<view class="workspace-card workspace-card--{{mode}}" bindtap="onCardTap">
  <!-- å·¥ä½œå®¤å›¾ç‰‡ -->
  <view class="workspace-card__image">
    <image class="workspace-card__image-img" src="{{workspace.image || util.getResource('images/default-workspace.png')}}" mode="aspectFill" />
    <!-- è¥ä¸šçŠ¶æ€æ ‡ç­¾ -->
    <view wx:if="{{showBusinessStatus}}" class="workspace-card__status {{workspace.isOpen ? 'workspace-card__status--open' : 'workspace-card__status--closed'}}">
      <text class="workspace-card__status-text">{{workspace.isOpen ? 'è¥ä¸šä¸­' : 'ä¼‘æ¯ä¸­'}}</text>
    </view>
    <!-- æ”¶è—æŒ‰é’® -->
    <view wx:if="{{showFavorite}}" class="workspace-card__favorite {{isFavorited ? 'workspace-card__favorite--active' : ''}}" bindtap="onFavoriteTap">
      <text class="workspace-card__favorite-icon">{{isFavorited ? 'â™¥' : 'â™¡'}}</text>
    </view>
  </view>

  <!-- å·¥ä½œå®¤ä¿¡æ¯ -->
  <view class="workspace-card__info">
    <!-- å·¥ä½œå®¤åç§° -->
    <view class="workspace-card__header">
      <text class="workspace-card__name">{{workspace.name || 'æœªçŸ¥å·¥ä½œå®¤'}}</text>
      <!-- è¯„åˆ† -->
      <view wx:if="{{showRating && workspace.rating}}" class="workspace-card__rating">
        <view class="workspace-card__stars">
          <text wx:for="{{5}}" wx:key="index" class="workspace-card__star {{index < Math.floor(workspace.rating) ? 'workspace-card__star--filled' : ''}}">
            â˜…
          </text>
        </view>
        <text class="workspace-card__rating-text">{{workspace.rating ? workspace.rating.toFixed(1) : ''}}</text>
      </view>
    </view>

    <!-- è¥ä¸šæ—¶é—´ -->
    <view wx:if="{{showBusinessHours && workspace.businessHours}}" class="workspace-card__business-hours">
      <text class="workspace-card__business-hours-text">{{workspace.businessHours}}</text>
      <text wx:if="{{workspace.todayHours}}" class="workspace-card__today-hours">ä»Šæ—¥ {{workspace.todayHours}}</text>
    </view>

    <!-- åœ°å€ä¿¡æ¯ -->
    <view wx:if="{{workspace.address}}" class="workspace-card__address">
      <text class="workspace-card__address-icon">ğŸ“</text>
      <text class="workspace-card__address-text">{{workspace.address}}</text>
    </view>

    <!-- æœåŠ¡æ ‡ç­¾ -->
    <view wx:if="{{showTags && workspace.services && workspace.services.length > 0}}" class="workspace-card__tags">
      <text wx:for="{{workspace.services}}" wx:key="index" class="workspace-card__tag">
        {{item}}
      </text>
    </view>

    <!-- è·ç¦»å’Œæ“ä½œæŒ‰é’® -->
    <view class="workspace-card__footer">
      <!-- è·ç¦»ä¿¡æ¯ -->
      <view wx:if="{{showDistance && workspace.distance}}" class="workspace-card__distance">
        <text class="workspace-card__distance-text">
          {{workspace.distance >= 1000 ? 'è·ä½ ' + (workspace.distance/1000).toFixed(1) + 'km' : 'è·ä½ ' + workspace.distance + 'm'}}
        </text>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="workspace-card__actions">
        <!-- å¯¼èˆªæŒ‰é’® -->
        <button class="workspace-card__nav-btn" bindtap="onNavigateTap" size="mini">
          å¯¼èˆª
        </button>

        <!-- é¢„çº¦æŒ‰é’® -->
        <button class="workspace-card__book-btn {{workspace.isOpen ? '' : 'workspace-card__book-btn--disabled'}}" bindtap="onBookTap" disabled="{{!workspace.isOpen}}" size="mini">
          {{workspace.isOpen ? 'é¢„çº¦' : 'ä¼‘æ¯ä¸­'}}
        </button>
      </view>
    </view>
  </view>
</view>